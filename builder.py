from datetime   import datetime
from hashlib    import sha1
from random     import randint
from base64     import b64encode
from httpx      import get
from time       import time
from json       import dumps

def encrypt_data(data):
    key = [89, 231, 225, 55]
    json_str = dumps(data)
    
    key_length = len(key)
    encrypted_chars = [
        chr(ord(char) ^ key[i % key_length]) 
        for i, char in enumerate(json_str)
    ]
    xor_encrypted = ''.join(encrypted_chars)
    
    return b64encode(xor_encrypted.encode('utf-8')).decode('utf-8')

def get_device_data(cookies:dict, ccjs_content:str, sid:str, cf:str):
    original_data = {'sid': 'bbc661585c424072', '_t': 'AXJhYv2ahknbo/fqhuCMP+5sZ6dAzR9ovrsrxG4rPm3GLlaoL0FD5Lp3Z2UJFxHwL3wPavzfh/fq+Rk539DlCXBONKn8+0tqb0bUIUpY+zqTjKlQHNHNCSsOiSMJNWM+o7E1BzkmrXrzABGh8dqUFAy09GuOtEdyMZ52gMNS8LAPw4E9MQg3PN8t2kXE6Xc+jCnOn7Mp7sVxCr47C+C2HSURvXPDCzBT6PKW4y48F72jhI4AOfwtXHXFhtjVwZRl17TbjqX+GjpYIowyW7uWE0Ls37bZZWzYXfR/OFW0pMs8d7aiZvDL7s5F5HGMty9LrrdzhcPOFiQCLo6rlAqLsjp5VdyN0SAxXA==', 'cf_flags': '1022963', 'cookie-_cc': 'AXJBnAQ14VBZJVxRmTrPKusW', 'cookie-_cid_cc': 'AXJBnAQ14VBZJVxRmTrPKusW', 'timing-sc': 1, 'time-unix-epoch-ms': 1732442274465, 'time-local': '11/24/2024, 10:57:54 AM', 'time-string': 'Sun Nov 24 2024 10:57:54 GMT+0100 (Central European Standard Time)', 'time-tz-offset-minutes': -60, 'time-tz-has-dst': 'true', 'time-tz-dst-active': 'false', 'time-tz-std-offset': -60, 'time-tz-fixed-locale-string': '3/6/2014, 7:58:39 AM', 'timing-ti': 0, 'dom-local-tag': 'AXJBnAQ14VBZJVxRmTrPKusW', 'timing-ls': 0, 'cid-dom-local-tag': 'AXJBnAQ14VBZJVxRmTrPKusW', 'timing-cidls': 0, 'dom-session-tag': 'AXJhYv2ahknbo/fqhuCMP+5s', 'timing-ss': 0, 'cid-dom-session-tag': 'AXJhYv2ahknbo/fqhuCMP+5s', 'timing-cidss': 0, 'navigator.appVersion': '5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36', 'navigator.appName': 'Netscape', 'navigator.product': 'Gecko', 'navigator.platform': 'Win32', 'navigator.language': 'en-US', 'navigator.userAgent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36', 'navigator.cookieEnabled': 'true', 'navigator.appCodeName': 'Mozilla', 'navigator.vendor': 'Google Inc.', 'navigator.productSub': '20030107', 'timing-no': 0, 'navigator.hardwareConcurrency': '3', 'navigator.deviceMemory': '2', 'touchEnabled': False, 'navigator.automationEnabled': False, 'navigator.doNotTrack': '', 'navigator.userAgentData.brands': [{'brand': 'Brave', 'version': '131'}, {'brand': 'Chromium', 'version': '131'}, {'brand': 'Not_A Brand', 'version': '24'}], 'navigator.userAgentData.mobile': False, 'navigator.userAgentData.platform': 'Windows', 'window.screen.colorDepth': '24', 'window.clientInformation.language': 'en-US', 'window.screen.pixelDepth': '24', 'window.history.length': '2', 'window.devicePixelRatio': '1', 'window.screen.height': '922', 'window.screen.width': '456', 'timing-wo': 0, 'window.screen.availHeight': '922', 'window.screen.orientation.type': 'landscape-primary', 'window.screen.orientation.angle': '0', 'window.screen.darkMode.enabled': True, 'timing-do': 0, 'plugin-document plug in-filename': 'BfPHLs1DozZrdOuf2bVSRQnbsWq899Hq', 'plugin-Web com.adobe.pdf extension-filename': 'Pq8HqVpzZz4cOuf2jwg36GDBfPHLs9mb', 'plugin-Web com.adobe.pdf extension-desc': 'Portable Document Format', 'plugin-c5k5kx3j-filename': 'PHLs9e2bVKs157d1', 'plugin-c5k5kx3j-desc': 'iwg3EpUKkaVSRQv268euAny4kx3bVSJj', 'plugin-MtePPm6-filename': 'y4k5cWLNOHDJMl5', 'plugin-MtePPm6-desc': 'RnTJr8HiwYUxg3EhvXTwBAIr8Hiwg3E', 'plugin-suffixes': '7la,pdf,y4k', 'plugin-mimes': 'application/pdf,application/x-google-chrome-pdf', 'timing-np': 0, 'timing-iepl': 0, 'canvas-print-100-999': '58f62c0aa29ef09e964a0679100020c0fbec747b', 'canvas-print-detailed-100-999': '7fdc94391fd074058a292b8dfe02b11e1ec28d1c', 'timing-cp': 26, 'timing-gief': 0, 'js-errors': ['InvalidCharacterError: Failed to execute \'createElement\' on \'Document\': The tag name provided (\'<object id="dialogHelperId" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0" height="0"></object>\') is not a valid name.', 'InvalidCharacterError: Failed to execute \'createElement\' on \'Document\': The tag name provided (\'<object id="dialogHelperId" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0" height="0"></object>\') is not a valid name.'], 'font-Times New Roman CYR': False, 'font-Arial CYR': False, 'font-Courier New CYR': False, 'font-宋体': False, 'font-Arial Cyr': False, 'font-Times New Roman Cyr': False, 'font-Courier New Cyr': False, 'font-华文细黑': False, 'font-儷黑 Pro': False, 'font-WP CyrillicB': False, 'font-WP CyrillicA': False, 'font-궁서체': False, 'font-細明體': False, 'font-小塚明朝 Pr6N B': False, 'font-宋体-PUA': False, 'font-方 正流行体繁体': False, 'font-汉仪娃娃篆简': False, 'font-돋움': False, 'font-GaramondNo4CyrTCYLig': False, 'font-HelveticaInseratCyr Upright': False, 'font-HelveticaCyr Upright': False, 'font-TL Help Cyrillic': False, 'font-가는안상수체': False, 'font-TLCyrillic2': False, 'font-AGRevueCyr-Roman': False, 'font-AGOptimaCyr': False, 'font-HelveticaInseratCyrillicUpright': False, 'font-HelveticaCyrillicUpright': False, 'font-HelveticaCyrillic': False, 'font-CyrillicRibbon': False, 'font-CyrillicHover': False, 'font-文鼎ＰＯＰ－４': False, 'font-方正中倩简体': False, 'font-创艺简中圆': False, 'font-Zrnic Cyr': False, 'font-Zipper1 Cyr': False, 'font-Xorx_windy Cyr': False, 'font-Xorx_Toothy Cyr': False, 'font-소야솔9': False, 'font-Цветные эмодзи Apple': False, 'font-Chinese Generic1': False, 'font-Korean Generic1': False, 'font-Bullets 5(Korean)': True, 'font-UkrainianFuturisExtra': False, 'font-VNI-Viettay': False, 'font-UkrainianCompact': False, 'font-UkrainianBrushScript': False, 'font-TiffanyUkraine': False, 'font-Baltica_Russian-ITV': False, 'font-Vietnamese font': False, 'font-Unicorn Ukrainian': False, 'font-UkrainianTimesET': False, 'font-UkrainianCourier': False, 'font-Tiff-HeavyUkraine': False, 'font-䡵湧䱡渠䅲瑤敳楧渠㈰〲\u202d⁁汬\u2072楧桴猠牥獥牶敤⹔桵⁰桡瀠噎周畦慰〲†乯牭慬ㄮ〠䍯摥⁖义\u2066潲⁗楮摯睳周畦慰〲乯牭慬HungLan Artdesign - http://www.vietcomic.comVNI-Thufap2  Normalv2.0 Code VNI for WindowsVNI-Thufap2 Normal\x02': True, 'font-Vietnam': False, 'font-Bwviet': False, 'font-Soviet': False, 'font-Soviet Expanded': False, 'font-Soviet Bold': False, 'font-Russian': False, 'font-UVN Han Viet': False, 'font-UkrainianAcademy': False, 'font-Symbol': True, 'font-Verdana': True, 'font-Webdings': True, 'font-Arial': True, 'font-Georgia': True, 'font-Courier New': True, 'font-Trebuchet MS': True, 'font-Times New Roman': True, 'font-Impact': True, 'font-Comic Sans MS': True, 'font-Wingdings': True, 'font-Tahoma': True, 'font-Microsoft Sans Serif': True, 'font-Arial Black': True, 'font-Plantagenet Cherokee': False, 'font-Arial Narrow': False, 'font-Wingdings 2': True, 'font-Wingdings 3': True, 'font-Arial Unicode MS': False, 'font-Papyrus': False, 'font-Calibri': True, 'font-Cambria': True, 'font-Consolas': True, 'font-Candara': True, 'font-Franklin Gothic Medium': True, 'font-Corbel': True, 'font-Constantia': True, 'font-Marlett': True, 'font-Lucida Console': True, 'font-Lucida Sans Unicode': True, 'font-MS Mincho': False, 'font-Arial Rounded MT Bold': False, 'font-Palatino Linotype': True, 'font-Batang': False, 'font-MS Gothic': True, 'font-PMingLiU': False, 'font-SimSun': True, 'font-MS PGothic': True, 'font-MS PMincho': False, 'font-Gulim': False, 'font-Cambria Math': True, 'font-Garamond': False, 'font-Bookman Old Style': False, 'font-Book Antiqua': False, 'font-Century Gothic': False, 'font-Monotype Corsiva': False, 'font-Courier': True, 'font-Meiryo': False, 'font-Century': False, 'font-MT Extra': False, 'font-MS Reference Sans Serif': False, 'font-MS Reference Specialty': False, 'font-Mistral': False, 'font-Bookshelf Symbol 7': True, 'font-Lucida Bright': False, 'font-Cooper Black': False, 'font-Modern No. 20': True, 'font-Bernard MT Condensed': False, 'font-Bell MT': False, 'font-Baskerville Old Face': False, 'font-Bauhaus 93': True, 'font-Britannic Bold': False, 'font-Wide Latin': False, 'font-Playbill': False, 'font-Harrington': False, 'font-Onyx': False, 'font-Footlight MT Light': False, 'font-Stencil': False, 'font-Colonna MT': False, 'font-Matura MT Script Capitals': False, 'font-Copperplate Gothic Bold': False, 'font-Copperplate Gothic Light': False, 'font-Edwardian Script ITC': False, 'font-Rockwell': False, 'font-Curlz MT': False, 'font-Engravers MT': False, 'font-Rockwell Extra Bold': False, 'font-Haettenschweiler': False, 'font-MingLiU': False, 'font-Mongolian Baiti': True, 'font-Microsoft Yi Baiti': True, 'font-Microsoft Himalaya': True, 'font-SimHei': False, 'font-SimSun-ExtB': True, 'font-PMingLiU-ExtB': True, 'font-MingLiU-ExtB': True, 'font-MingLiU_HKSCS-ExtB': True, 'font-MingLiU_HKSCS': False, 'font-Gabriola': True, 'font-Goudy Old Style': False, 'font-Calisto MT': False, 'font-Imprint MT Shadow': False, 'font-Gill Sans Ultra Bold': False, 'font-Century Schoolbook': False, 'font-Gloucester MT Extra Condensed': False, 'font-Perpetua': False, 'font-Franklin Gothic Book': False, 'font-Brush Script MT': False, 'font-Microsoft Tai Le': True, 'font-Gill Sans MT': False, 'font-Tw Cen MT': False, 'font-Lucida Handwriting': False, 'font-Lucida Sans': False, 'font-Segoe UI': True, 'font-Lucida Fax': False, 'font-MV Boli': True, 'font-Sylfaen': True, 'font-Estrangelo Edessa': False, 'font-Mangal': False, 'font-Gautami': False, 'font-Tunga': False, 'font-Shruti': False, 'font-Raavi': False, 'font-Latha': False, 'font-Lucida Calligraphy': False, 'font-Lucida Sans Typewriter': False, 'font-Kartika': False, 'font-Vrinda': False, 'font-Perpetua Titling MT': False, 'font-Cordia New': False, 'font-Angsana New': False, 'font-IrisUPC': False, 'font-CordiaUPC': False, 'font-FreesiaUPC': False, 'font-Miriam': False, 'font-Traditional Arabic': False, 'font-Miriam Fixed': False, 'font-JasmineUPC': False, 'font-KodchiangUPC': False, 'font-LilyUPC': False, 'font-Levenim MT': False, 'font-EucrosiaUPC': False, 'font-DilleniaUPC': False, 'font-Rod': False, 'font-Narkisim': False, 'font-FrankRuehl': False, 'font-David': False, 'font-Andalus': False, 'font-Browallia New': False, 'font-AngsanaUPC': False, 'font-BrowalliaUPC': False, 'font-MS UI Gothic': True, 'font-Aharoni': False, 'font-Simplified Arabic Fixed': False, 'font-Simplified Arabic': False, 'font-GulimChe': False, 'font-Dotum': False, 'font-DotumChe': False, 'font-GungsuhChe': False, 'font-Gungsuh': False, 'font-BatangChe': False, 'font-Meiryo UI': False, 'font-NSimSun': True, 'font-Segoe Script': True, 'font-Segoe Print': True, 'font-DaunPenh': False, 'font-Kalinga': False, 'font-Iskoola Pota': False, 'font-Euphemia': False, 'font-DokChampa': False, 'font-Nyala': False, 'font-MoolBoran': False, 'font-Leelawadee': False, 'font-Gisha': False, 'font-Microsoft Uighur': False, 'font-Arabic Typesetting': False, 'font-Malgun Gothic': True, 'font-Microsoft JhengHei': True, 'font-DFKai-SB': False, 'font-Microsoft YaHei': True, 'font-FangSong': False, 'font-KaiTi': False, 'font-Helvetica': True, 'font-Segoe UI Light': True, 'font-Segoe UI Semibold': True, 'font-Andale Mono': False, 'font-Palatino': False, 'font-Geneva': False, 'font-Monaco': False, 'font-Lucida Grande': False, 'font-Gill Sans': False, 'font-Helvetica Neue': False, 'font-Baskerville': False, 'font-Hoefler Text': False, 'font-Thonburi': False, 'font-Herculanum': False, 'font-Apple Chancery': False, 'font-Didot': False, 'font-Zapf Dingbats': False, 'font-Apple Symbols': False, 'font-Copperplate': False, 'font-American Typewriter': False, 'font-Zapfino': False, 'font-Cochin': False, 'font-Chalkboard': False, 'font-Sathu': False, 'font-Osaka': False, 'font-BiauKai': False, 'font-Segoe UI Symbol': True, 'font-Aparajita': False, 'font-Krungthep': False, 'font-Ebrima': True, 'font-Silom': False, 'font-Kokila': False, 'font-Shonar Bangla': False, 'font-Sakkal Majalla': False, 'font-Microsoft PhagsPa': True, 'font-Microsoft New Tai Lue': True, 'font-Khmer UI': False, 'font-Vijaya': False, 'font-Utsaah': False, 'font-Charcoal CY': False, 'font-Ayuthaya': False, 'font-InaiMathi': False, 'font-Euphemia UCAS': False, 'font-Vani': False, 'font-Lao UI': False, 'font-GB18030 Bitmap': False, 'font-KufiStandardGK': False, 'font-Geeza Pro': False, 'font-Chalkduster': False, 'font-Tempus Sans ITC': False, 'font-Kristen ITC': False, 'font-Apple Braille': False, 'font-Juice ITC': False, 'font-STHeiti': False, 'font-LiHei Pro': False, 'font-DecoType Naskh': False, 'font-New Peninim MT': False, 'font-Nadeem': False, 'font-Mshtakan': False, 'font-Gujarati MT': False, 'font-Devanagari MT': False, 'font-Arial Hebrew': False, 'font-Corsiva Hebrew': False, 'font-Baghdad': False, 'font-STFangsong': False, 'timing-kf': 36, 'webgl-supported': True, 'webgl-extensions': ['ANGLE_instanced_arrays', 'EXT_blend_minmax', 'EXT_clip_control', 'EXT_color_buffer_half_float', 'EXT_depth_clamp', 'EXT_disjoint_timer_query', 'EXT_float_blend', 'EXT_frag_depth', 'EXT_polygon_offset_clamp', 'EXT_shader_texture_lod', 'EXT_texture_compression_bptc', 'EXT_texture_compression_rgtc', 'EXT_texture_filter_anisotropic', 'EXT_texture_mirror_clamp_to_edge', 'EXT_sRGB', 'KHR_parallel_shader_compile', 'OES_element_index_uint', 'OES_fbo_render_mipmap', 'OES_standard_derivatives', 'OES_texture_float', 'OES_texture_float_linear', 'OES_texture_half_float', 'OES_texture_half_float_linear', 'OES_vertex_array_object', 'WEBGL_blend_func_extended', 'WEBGL_color_buffer_float', 'WEBGL_compressed_texture_s3tc', 'WEBGL_compressed_texture_s3tc_srgb', 'WEBGL_debug_renderer_info', 'WEBGL_debug_shaders', 'WEBGL_depth_texture', 'WEBGL_draw_buffers', 'WEBGL_lose_context', 'WEBGL_multi_draw', 'WEBGL_polygon_mode'], 'webgl-max-aa': '16', 'webgl-version': 'WebGL 1.0 (OpenGL ES 2.0 Chromium)', 'webgl-glsl-version': 'WebGL GLSL ES 1.0 (OpenGL ES GLSL ES 1.0 Chromium)', 'webgl-vendor': 'WebKit', 'webgl-renderer': 'WebKit WebGL', 'webgl-vendor-real': 'Google Inc. (NVIDIA)', 'webgl-renderer-real': 'ANGLE (NVIDIA, NVIDIA GeForce GTX 1060 6GB (0x00001C03) Direct3D11 vs_5_0 ps_5_0, D3D11)', 'timing-wgl': 11, 'timing-DEVICE-ORIENTATION': 0, 'timing-sync-collection': 79, 'ccjs_version': 'VVtCQOrE1bexrM1PGJ8kNg==', 'timing-generation': 1, 'script-load-time': 1732442274375, 'device-data-captured-time': 1732442274540, 'navigator.battery.level': '1', 'navigator.battery.charging': 'true', 'navigator.battery.chargingTime': '0', 'navigator.battery.dischargingTime': None, 'document.storage.access': True, 'timing-STORAGE-ACCESS': 78}

    now = datetime.now()
    original_data['time-unix-epoch-ms'] = int(time() * 1000)
    original_data['time-local']         = now.strftime("%m/%d/%Y, %I:%M:%S %p")
    original_data['time-string']        = now.strftime("%a %b %d %Y %I:%M:%S %p %Z") + " (Central European Standard Time)"

    original_data['script-load-time']           = int(time() * 1000)
    original_data['device-data-captured-time']  = int(time() * 1000) + randint(50,130)

    original_data['sid']          = sid
    original_data['_t']           = ccjs_content.split(';N="')[1].split('"')[0]
    original_data['cf_flags']     = cf
    original_data['ccjs_version'] = ccjs_content.split('ccjs_version","')[1].split('"')[0]
    original_data['js-errors'] = [
        'InvalidCharacterError: Failed to execute \'createElement\' on \'Document\': The tag name provided (\'<object id="dialogHelperId" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0" height="0"></object>\') is not a valid name.'.replace(
            '3050f819-98b5-11cf-bb82-00aa00bdce0b',
            ccjs_content.split(r'dialogHelperId" classid\x3d"clsid:')[1].split('"')[0]
        )
    ]

    original_data['cookie-_cc']          = cookies['_cc']
    original_data['dom-local-tag']       = cookies['_cc']

    original_data['cookie-_cid_cc']      = cookies['_cid_cc']
    original_data['cid-dom-local-tag']   = cookies['_cid_cc']

    original_data['dom-session-tag']     = cookies['_cc']
    original_data['cid-dom-session-tag'] = cookies['_cid_cc']

    fingerprint = get('https://fingerprints.bablosoft.com/preview?rand=0.22834126184040704&tags=Microsoft%20Windows,Desktop,Chrome').json()
    original_data['webgl-vendor-real']   = fingerprint['vendor']
    original_data['webgl-renderer-real'] = fingerprint['renderer']

    original_data['canvas-print-100-999']           = sha1(str(randint(1,10000000)).encode()).hexdigest()
    original_data['canvas-print-detailed-100-999']  = sha1(str(randint(1,10000000)).encode()).hexdigest()

    return encrypt_data(original_data)

if __name__ == "__main__":
    print(
        get_device_data(
            {'_ua': '{"session_id":"3555b84f-1521-4822-ba75-eff29947a904","session_time_ms":1732441716613}','marketing_vistor_id': '04f56e40-1e69-413e-84ca-0b1467443a73','usl.territory': '3.wsznKglEOH+AiZ0p/a1Vu1cI2iiF3i2or9xhkWilgek=','udi-id': 'gGsZRMh2OLahfzhmb+Kx0VfnE8pGBJd0fEzrXgLCJGkClBQJFXTMhBXSHWTTiWyQ+sgnHp1h/yKZjS4A80HBjLKA65gkumzy4zxTXJuOgKEtL2uJifKwJE0O6vYEpVuzNsSYRBaj/joiEdqwGGjZfcPDkwn1mJaCp51Rh5DPA8zdAdkvxdMRAFXtEKGtfDFiBHQJFnqgk4HHviNUrUyAeQ==ie6KSvNGpylD0GR2LsrNZw==GE8vvah6ny3IMKMQlBZtfLl92B0TTOe35VWet5JV16U=','jwt-session': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InNsYXRlLWV4cGlyZXMtYXQiOjE3MzI0NDM1MTY2MzN9LCJpYXQiOjE3MzI0NDE3MTYsImV4cCI6MTczMjUyODExNn0.Mmf4K-ZD5BKk9VJjjHr7hODqnH8Np7Iu0IaW-bv3I7o','_cc': 'AXJBnAQ14VBZJVxRmTrPKusW','_cid_cc': 'AXJBnAQ14VBZJVxRmTrPKusW','udi-fingerprint': 'KhURyvFVX9+p7WyNYYpzxca2jeNp2+X1BLy06ngHZY2mp+BLPdvBCiMm5uL9LhUjKJnfpVMfZPeoU0IPbIOnaA==L7aX0MkUjYUS/9VxfoOrHtFo8rYewTW56UDQVm05m8Y='},
            get('https://www.cdn-net.com/cc.js?sid=bbc661585c424072').text,
            "bbc661585c424072",
            "1022963"
        )
    )